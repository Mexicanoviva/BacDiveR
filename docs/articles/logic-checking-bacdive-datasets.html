<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Logic-Checking BacDive Datasets • BacDiveR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Logic-Checking BacDive Datasets">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BacDiveR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.7.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/BacDive-ing-in.html">BacDive-ing in</a>
    </li>
    <li>
      <a href="../articles/adr-001-JSON-not-XML.html">ADR 1: Using JSON internally, instead of XML</a>
    </li>
    <li>
      <a href="../articles/adr-002-two-download-functions-returning-datasets.html">ADR 2: Two download functions that return full datasets by default</a>
    </li>
    <li>
      <a href="../articles/logic-checking-bacdive-datasets.html">Logic-Checking BacDive Datasets</a>
    </li>
    <li>
      <a href="../articles/pre-configuring-advanced-searches-and-retrieving-the-results.html">Pre-Configuring Advanced Searches and Retrieving the Results</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/TIBHannover/BacDiveR">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Logic-Checking BacDive Datasets</h1>
                        <h4 class="author">Katrin Leinweber</h4>
            
            <h4 class="date">2018-11-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/TIBHannover/BacDiveR/blob/master/vignettes/logic-checking-bacdive-datasets.Rmd"><code>vignettes/logic-checking-bacdive-datasets.Rmd</code></a></small>
      <div class="hidden name"><code>logic-checking-bacdive-datasets.Rmd</code></div>

    </div>

    
    
<div id="example-of-a-data-inconsistency" class="section level2">
<h2 class="hasAnchor">
<a href="#example-of-a-data-inconsistency" class="anchor"></a>Example of a data inconsistency</h2>
<p>Just as the correctness of data analysis code should be tested automatically, the consistency of data should be evaluated and monitored as well. Using <a href="https://bacdive.dsmz.de/AdvSearch">BacDive’s advanced search</a> and <a href="https://tibhannover.github.io/BacDiveR/reference/retrieve_search_results.html">BacDiveR’s <code><a href="../reference/retrieve_search_results.html">retrieve_search_results()</a></code></a> several examples of geographic inconsistencies have been found. Presumably due to an overly strict location-to-country-to-continent mapping, several samples collected from seas neighbouring Russia (like the <a href="https://bacdive.dsmz.de/advsearch?site=advsearch&amp;searchparams%5B20%5D%5Bcontenttype%5D=text&amp;searchparams%5B20%5D%5Btypecontent%5D=contains&amp;searchparams%5B20%5D%5Bsearchterm%5D=Sea+of+Japan&amp;searchparams%5B100%5D%5Bcontenttype%5D=text&amp;searchparams%5B100%5D%5Btypecontent%5D=contains&amp;searchparams%5B100%5D%5Bsearchterm%5D=&amp;searchparams%5B17%5D%5Bsearchterm%5D=Europe&amp;advsearch=search">Sea of Japan)</a>, were assigned to Europe.</p>
<div class="figure">
<img src="BacDive-geo-logic-fault.png" alt="Two datasets with a geo-logic fault (pun intended)"><p class="caption">Two datasets with a geo-logic fault (pun intended)</p>
</div>
<p>While one may debate where exactly border between Asia and Europe runs through Russia, it is clear that its Eastern shoreline is located well within Asia. These and other datasets with East Russian locations have been reported to the BacDive team and a portion of those was corrected in <a href="https://bacdive.dsmz.de/news">BacDive’s 04.07.2018 release</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(BacDiveR)
  
inconsistent_data &lt;-<span class="st"> </span><span class="kw"><a href="../reference/retrieve_search_results.html">retrieve_search_results</a></span>(
  <span class="st">"https://bacdive.dsmz.de/advsearch?advsearch=search&amp;site=advsearch&amp;searchparams[20][contenttype]=text&amp;searchparams[20][typecontent]=contains&amp;searchparams[20][searchterm]=Sea+of+Japan&amp;searchparams[17][searchterm]=Europe"</span>
  )
<span class="co">#&gt; Downloading BacDive IDs 131115 to 139987 (but not necessarily contiguously):</span>
<span class="co">#&gt; 131115 139987</span></code></pre></div>
<p>As long as this specific inconsistency is not fixed, the above should display: <code>Downloading BacDive IDs: 131115 139987</code>.</p>
</div>
<div id="how-to-test-datasets" class="section level2">
<h2 class="hasAnchor">
<a href="#how-to-test-datasets" class="anchor"></a>How to test datasets</h2>
<p>If a BacDive user finds an inconsistency within the datasets they use, BacDiveR’s <code><a href="../reference/retrieve_search_results.html">retrieve_search_results()</a></code> can be used to construct a test-case for such a problem. In the following example, the test fails as long as BacDive contains datasets with the above-described discrepancy between the <code>geo_loc_name</code> and <code>continent</code> fields.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(testthat)

<span class="kw"><a href="https://www.rdocumentation.org/packages/testthat/topics/test_that">test_that</a></span>(<span class="st">"No inconsistent datasets exist"</span>, {
  <span class="kw"><a href="https://www.rdocumentation.org/packages/testthat/topics/inheritance-expectations">expect_null</a></span>(inconsistent_data)
})
<span class="co">#&gt; Error: Test failed: 'No inconsistent datasets exist'</span>
<span class="co">#&gt; * `inconsistent_data` is not null.</span></code></pre></div>
<p>Once the inconsistency is corrected in BacDive, the advanced search returns no results any more, and the above test passes. It can thus be used to monitor the resolution of such a problem after <a href="https://bacdive.dsmz.de/?site=contact">reporting</a> it. Furthermore, the users is alerted (by the test failing again) in case new datasets appear in BacDive with the same inconsistency.</p>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<p>See <a href="https://testthat.r-lib.org/">testthat.R-lib.org</a> and the <a href="http://r-pkgs.had.co.nz/tests.html">related “R Packages” chapter</a> to learn more about testing in R <span class="citation">(Wickham 2011; Wickham 2015)</span>.</p>
<div id="refs" class="references">
<div id="ref-TT">
<p>Wickham, Hadley. 2011. “Testthat: Get Started with Testing.” <em>The R Journal</em> 3: 5–10. <a href="https://journal.r-project.org/archive/2011-1/RJournal_2011-1_Wickham.pdf" class="uri">https://journal.r-project.org/archive/2011-1/RJournal_2011-1_Wickham.pdf</a>.</p>
</div>
<div id="ref-T">
<p>———. 2015. <em>R Packages: Organize, Test, Document, and Share Your Code</em>. 1st edition. Sebastopol, CA: O’Reilly Media. <a href="http://r-pkgs.had.co.nz/" class="uri">http://r-pkgs.had.co.nz/</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#example-of-a-data-inconsistency">Example of a data inconsistency</a></li>
      <li><a href="#how-to-test-datasets">How to test datasets</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Katrin Leinweber.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.2.0.9000.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
